{"version":3,"file":"static/webpack/static\\development\\pages\\dashboard\\admin\\users\\blocked.js.5fa25b25fee67b0b8cd3.hot-update.js","sources":["webpack:///./pages/dashboard/admin/users/blocked.js"],"sourcesContent":["import AdminLayoutHoc from '../../../../components/Layout/AdminLayoutHoc';\r\nimport Link from 'next/link';\r\nimport Table from '../../../../components/Table';\r\nimport Modal from '../../../../components/Modal';\r\nimport Alert from '../../../../components/Alert';\r\nimport { withRouter } from 'next/router';\r\n\r\nclass Index extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      data: [],\r\n      block: {\r\n        id: 0,\r\n        name: '',\r\n        reason_block: 'none',\r\n      },\r\n      total: 0,\r\n      table: {\r\n        pages: 0,\r\n        loading: false,\r\n        header: [\r\n          {title: \"#\", size: \"75px\"},\r\n          {title: \"Profile\", size: \"150px\"},\r\n          {title: \"Name\", size: \"auto\"},\r\n          {title: \"Reason\", size: \"auto\"},\r\n          {title: \"Action\", size: \"200px\"}\r\n        ]\r\n      },\r\n      alert: {\r\n        block_danger: '',\r\n        block_success: '',\r\n      }\r\n    }\r\n\r\n    this.onBlock = this.onBlock.bind(this)\r\n    this.onRefresh = this.onRefresh.bind(this)\r\n    this.submitBlock = this.submitBlock.bind(this)\r\n  }\r\n\r\n  onBlock (user) {\r\n    const {block} = this.state\r\n    block.id = user.id\r\n    block.name = user.name\r\n\r\n    this.setState({block})\r\n  }\r\n\r\n  async onRefresh () {\r\n    const table = this.state.table\r\n    table.loading = true\r\n    this.setState({ table })\r\n\r\n    let {page} = this.props.router.query\r\n    if (typeof page === \"undefined\") page = 1\r\n\r\n    const response = await fetch(`http://127.0.0.1:8000/fact/user?status=blocked&page=${page}`)\r\n    const json = await response.json()\r\n\r\n    const data = json.results.users\r\n    const total = json.results.total\r\n    table.pages = json.results.pages\r\n    table.loading = false\r\n\r\n    this.setState({ data, table, total })\r\n  }\r\n\r\n  async submitBlock () {\r\n    const alert = this.state.alert\r\n    const body = JSON.stringify(this.state.block)\r\n    const response = await fetch(`http://127.0.0.1:8000/fact/user/` + this.state.block.id, {method: 'DELETE', body})\r\n    const json = await response.json()\r\n\r\n    if (typeof json.message === 'undefined' || json.message !== 'Success') {\r\n      alert.block_danger = \"500 — Internal Server Error\"\r\n      await this.setState({alert})\r\n    }\r\n    else {\r\n      alert.block_success = \"Block User, \" + body.name + \" — Success\"\r\n      const block = {\r\n        id: 0,\r\n        name: '',\r\n        reason_block: 'none',\r\n      }\r\n\r\n      await this.setState({alert, block})\r\n      await this.onRefresh()\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.onRefresh()\r\n  }\r\n\r\n  render() {\r\n    const tbody = []\r\n    for (let i = 0, l = this.state.data.length; i < l; i++) {\r\n      const user = this.state.data[i];\r\n      tbody.push(\r\n        <tr key={user.id}>\r\n          <td>{i + 1}</td>\r\n          <td>\r\n            <i className=\"fa fa-user-circle\" style={{fontSize: \"50px\"}}/>\r\n          </td>\r\n          <td>{user.name}</td>\r\n          <td>{user.reason_block}</td>\r\n          <td>\r\n            <button className=\"btn btn-link text-danger ml-3\" data-toggle=\"modal\" data-target=\"#unblock\" onClick={() =>  this.onBlock(user)}>Unblock</button>\r\n          </td>\r\n        </tr>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <AdminLayoutHoc contentTitle={`Blocked Users (${this.state.total})`} contentBreadcrumb={[\"Home\", \"Users\", \"Blocked Users\"]}>\r\n        <Alert type=\"danger\" component={this} attribute=\"block_danger\"/>\r\n        <Alert type=\"success\" component={this} attribute=\"block_success\"/>\r\n\r\n        <Table table={this.state.table}>\r\n          {tbody}\r\n        </Table>\r\n\r\n        <Modal id=\"unblock\" title=\"Unblock User\">\r\n          <div className=\"modal-body\">\r\n            <p>Are you sure you want to unblock {this.state.block.name}?</p>\r\n          </div>\r\n          <div className=\"modal-footer\">\r\n            <div className=\"col-md-6\">\r\n              <button type=\"button\" className=\"btn btn-danger btn-block\" data-dismiss=\"modal\" data-toggle=\"modal\" onClick={this.submitBlock}>Yes</button>\r\n            </div>\r\n            <div className=\"col-md-6\">\r\n              <button type=\"button\" className=\"btn btn-light btn-block\" data-dismiss=\"modal\">No</button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n\r\n      </AdminLayoutHoc>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Index)\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AARA;AAWA;AACA;AACA;AAFA;AAnBA;AAyBA;AACA;AACA;AA7BA;AA8BA;AACA;;;AACA;AAAA;AAEA;AACA;AAEA;AAAA;AAAA;AACA;;;;;;;;;;;;AAGA;AACA;AACA;AAAA;AAAA;AAEA;AACA;;AAEA;AACA;;AADA;;AACA;AACA;;AADA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;;AACA;AAAA;AAAA;AAAA;AACA;;AADA;;AACA;AACA;;AADA;AACA;AACA;;;;;AACA;;AACA;AAAA;AAAA;AACA;;;;;;AAEA;AACA;AACA;AACA;AACA;AAHA;;AAMA;AAAA;AAAA;AAAA;AACA;;;AAAA;AACA;;;;;;;;;;;;;;;;;AAGA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAFA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAbA;AACA;AACA;AAAA;AAeA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;;;;AAnIA;AACA;AAqIA;;;;A","sourceRoot":""}