{"version":3,"file":"static/webpack/static\\development\\pages\\dashboard\\admin\\newsfeed\\articles.js.d678491b42bc247350fe.hot-update.js","sources":["webpack:///./components/DashboardArticle/ViewLists.js"],"sourcesContent":["import AdminLayoutHoc from '../Layout/AdminLayoutHoc';\r\nimport SearchInput from '../SearchInput';\r\nimport Table from '../Table';\r\nimport Modal from '../Modal';\r\nimport Alert from '../Alert';\r\nimport Link from 'next/link';\r\nimport Router from 'next/router'\r\nimport { withRouter } from 'next/router';\r\n\r\nclass Index extends React.Component {\r\n  constructor (props) {\r\n    super(props);\r\n    this.state = {\r\n      data: [],\r\n      search: '',\r\n      total: 0,\r\n      table: {\r\n        pages: 0,\r\n        loading: false,\r\n        header: [\r\n          {title: \"#\", size: \"50px\"},\r\n          {title: \"Title\", size: \"auto\"},\r\n          {title: \"Author\", size: \"auto\"},\r\n          {title: \"Published on\", size: \"auto\"},\r\n          {title: \"Published by\", size: \"auto\"},\r\n          {title: \"Action\", size: \"200px\"}\r\n        ],\r\n      },\r\n      delete: {\r\n        id: -1,\r\n        title: \"\"\r\n      },\r\n      alert: {\r\n        delete_danger: '',\r\n        delete_success: ''\r\n      },\r\n    };\r\n\r\n    this.onRefresh = this.onRefresh.bind(this);\r\n    this.queryTitle = this.queryTitle.bind(this);\r\n    this.deleteArticle = this.deleteArticle.bind(this);\r\n  }\r\n\r\n  async onRefresh () {\r\n    const table = this.state.table\r\n    table.loading = true\r\n    await this.setState({ table })\r\n\r\n    let {page, title} = this.props.router.query\r\n    if (typeof page === \"undefined\") page = 1\r\n    if (typeof title === \"undefined\") title = \"\"\r\n\r\n    const response = await fetch(`http://127.0.0.1:8000/fact/article?page=${page}&title=${title}`)\r\n    const json = await response.json()\r\n\r\n    const data = json.results.articles\r\n    const total = json.results.total\r\n    table.pages = json.results.pages\r\n    table.loading = false\r\n\r\n    this.setState({ data, table, total })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.onRefresh()\r\n  }\r\n\r\n  async queryTitle () {\r\n    await Router.push({\r\n      pathname: '/dashboard/admin/newsfeed/articles',\r\n      query: {\r\n        page: 1,\r\n        title: this.state.search\r\n      }\r\n    })\r\n    this.onRefresh()\r\n  }\r\n\r\n  deleteArticle (article) {\r\n    const data = this.state.delete\r\n    data.id = article.id\r\n    data.title = article.title\r\n\r\n    this.setState({ delete: data })\r\n  }\r\n\r\n  render() {\r\n    const tbody = []\r\n    for (let i = 0, l = this.state.data.length; i < l; i++) {\r\n      const article = this.state.data[i];\r\n      const date = new Date(article.published_on)\r\n\r\n      tbody.push(\r\n        <tr key={article.id}>\r\n          <td>{i + 1}</td>\r\n          <td>{article.title}</td>\r\n          <td>{article.author}</td>\r\n          <td>{date.dateformat()}</td>\r\n          <td>{article.published_by}</td>\r\n          <td>\r\n            <Link href={`/dashboard/admin/newsfeed/articles?status=view&id=${article.id}`}>\r\n              <a className=\"btn btn-link\">View</a>\r\n            </Link>\r\n            <button className=\"btn btn-link text-danger ml-3\" data-toggle=\"modal\" data-target=\"#delete\" onClick={() =>  this.deleteArticle(article)}>Delete</button>\r\n          </td>\r\n        </tr>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <AdminLayoutHoc contentTitle={`Articles (${this.state.total})`} contentBreadcrumb={[\"Home\", \"Newsfeed\", \"Articles\"]}>\r\n        <Alert type=\"danger\" component={this} attribute=\"delete_danger\"/>\r\n        <Alert type=\"success\" component={this} attribute=\"delete_success\"/>\r\n        <div className=\"card\">\r\n          <div className=\"card-body\">\r\n            <form className=\"form-inline\">\r\n              <SearchInput placeholder=\"Search by title\" onClick={this.queryTitle} value={this.state.search} onChange={(event) => this.setState({search: event.target.value})}/>\r\n              <Link href=\"/dashboard/admin/newsfeed/articles?status=add\">\r\n                <a className=\"btn btn-info ml-auto\">\r\n                  <i className=\"fa fa-plus\" /> Add Article\r\n                </a>\r\n              </Link>\r\n            </form>\r\n          </div>\r\n        </div>\r\n\r\n        <Table table={this.state.table}>\r\n          {tbody}\r\n        </Table>\r\n\r\n        <Modal id=\"delete\" title=\"Delete Article\">\r\n          <div className=\"modal-body\">\r\n            <span>Are you sure you want to delete {this.state.delete.title}?</span>\r\n          </div>\r\n          <div className=\"modal-footer\">\r\n            <div className=\"col-md-6\">\r\n              <button type=\"button\" className=\"btn btn-light btn-block\" data-dismiss=\"modal\">No</button>\r\n            </div>\r\n            <div className=\"col-md-6\">\r\n              <button type=\"button\" className=\"btn btn-danger btn-block\">Yes</button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      </AdminLayoutHoc>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Index)\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AATA;AAYA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AApBA;AA0BA;AACA;AACA;AA9BA;AA+BA;AACA;;;;;;;;;;;;;AAEA;AACA;;AACA;AAAA;AAAA;AACA;;AACA;AACA;AACA;;AAEA;AACA;;AADA;;AACA;AACA;;AADA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;;;;;;;;;;;;AAGA;AACA;AACA;AACA;AACA;AAFA;AAFA;AACA;;AAMA;AACA;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAFA;AAGA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAjBA;AACA;AACA;AAAA;AAmBA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;;;AAxIA;AACA;AA0IA;;;;A","sourceRoot":""}